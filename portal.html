<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Pratos & Produção – Sistema Unificado</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><rect width="128" height="128" rx="24" fill="%237b1e3a"/><text x="64" y="82" text-anchor="middle" font-family="Arial" font-size="56" fill="white">PP</text></svg>' />
  <style>
    :root{--bg:#f6f8fb;--ink:#0b1220;--muted:#667085;--line:#e6e7eb;--card:#fff;--wine:#7b1e3a;--wine-50:#f6eef1}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font:14px/1.55 ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu}
    .wrap{max-width:1200px;margin:24px auto;padding:0 16px}
    .top{display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:12px}
    h1{font-size:20px;margin:0}
    .status{color:#059669}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .tab{padding:10px 14px;border:1px solid var(--line);border-radius:12px;background:#fff;cursor:pointer}
    .tab.active{background:var(--wine-50);border-color:#e7cbd7;font-weight:700}
    .panel{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:10px;box-shadow:0 8px 24px rgba(10,18,32,.05)}
    .help{font-size:12px;color:var(--muted);margin:6px 0 10px}
    .frame{position:relative;border:1px dashed var(--line);border-radius:12px;overflow:hidden;background:#fff}
    iframe{display:block;width:100%;height:72vh;border:0;background:#fff}
    .loader{position:absolute;inset:0;display:grid;place-items:center;background:rgba(255,255,255,.6)}
    .dot{width:10px;height:10px;border-radius:50%;background:var(--wine);animation:b .9s infinite alternate}
    @keyframes b{to{transform:scale(1.6);opacity:.35}}
    .err{margin-top:10px;padding:12px;border:1px solid #fecaca;background:#fff1f2;color:#991b1b;border-radius:10px}
    .hidden{display:none!important}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <h1>Pratos & Produção – Sistema Unificado</h1>
      <div class="status">Pronto</div>
    </div>

    <div class="tabs" id="mainTabs">
      <button class="tab active" data-tab="dash">Dash Pratos</button>
      <button class="tab" data-tab="prod">Produção</button>
    </div>

    <!-- DASH PRATOS -->
    <section id="panel-dash" class="panel">
      <div class="help">Carrega <code>./dash_pratos/index.html</code> (módulo existente do dashboard de pratos).</div>
      <div class="frame">
        <div id="loader-dash" class="loader"><div class="dot" aria-hidden="true"></div></div>
        <iframe id="iframe-dash" title="Dash Pratos" src="./dash_pratos/index.html"></iframe>
      </div>
      <div id="err-dash" class="err hidden">Não foi possível carregar <b>dash_pratos/index.html</b>. Verifique caminho/arquivo no repositório.</div>
    </section>

    <!-- PRODUÇÃO -->
    <section id="panel-prod" class="panel hidden">
      <div class="help">Carrega <code>./app.html</code> (seu módulo com Mapa de Produção + Cadastros).</div>
      <div class="frame">
        <div id="loader-prod" class="loader"><div class="dot" aria-hidden="true"></div></div>
        <iframe id="iframe-prod" title="Produção" src="./app.html"></iframe>
      </div>
      <div id="err-prod" class="err hidden">Não foi possível carregar <b>app.html</b>. Verifique caminho/arquivo no repositório.</div>
    </section>
  </div>

  <script>
    const $ = (q, el=document) => el.querySelector(q);
    const $$ = (q, el=document) => [...el.querySelectorAll(q)];
    const show = (el, yes) => el.classList[yes ? 'remove':'add']('hidden');

    // Tabs
    const panels = { dash: $('#panel-dash'), prod: $('#panel-prod') };
    function activate(tab){
      $$('#mainTabs .tab').forEach(b => b.classList.toggle('active', b.dataset.tab===tab));
      Object.entries(panels).forEach(([k,sec]) => show(sec, k===tab));
      try{ localStorage.setItem('portal.tab', tab); }catch{}
    }
    $('#mainTabs').addEventListener('click', (e)=>{
      const btn = e.target.closest('.tab'); if(!btn) return;
      activate(btn.dataset.tab);
    });

    // Loaders/erros
    function attachLoader(iframeId, loaderId, errId){
      const iframe = document.getElementById(iframeId);
      const loader = document.getElementById(loaderId);
      const errBox = document.getElementById(errId);
      show(loader,true); show(errBox,false);
      const timer = setTimeout(()=>{ show(loader,false); show(errBox,true); }, 8000);
      iframe.addEventListener('load', ()=>{ clearTimeout(timer); show(loader,false); });
    }
    attachLoader('iframe-dash','loader-dash','err-dash');
    attachLoader('iframe-prod','loader-prod','err-prod');

    // Estado inicial
    activate(localStorage.getItem('portal.tab') || 'dash');
  </script>
</body>
</html>
