<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>DASHBOARD EXECUTIVO — CFO v10.2 (Layout Final)</title>
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><rect x="0" y="0" width="128" height="128" rx="24" fill="%232f6ef7"/><text x="64" y="78" text-anchor="middle" font-family="Arial" font-size="56" fill="white">CFO</text></svg>'/>
  <link rel="stylesheet" href="estoque_dash_vendas_styles.css">
</head>
<body>
  <div class="wrap">
    <main class="main main-content">
      <div class="top">
        <div class="brand">
          <div class="tabs" id="tabs">
            <button class="active" data-tab="vendas">Vendas</button>
            <button data-tab="analitico">Analítico</button>
            <button data-tab="diagnostico">Diagnóstico</button>
          </div>
        </div>
        <div class="upload-bar">
          <span id="status" class="muted">—</span><span id="diag" class="diag"></span>
        </div>
      </div>
      <div class="content">
        <div class="tab active" id="tab-vendas">
          <section class="kpi-grid">
            <div class="kpi active" data-kpi="fat"><div class="label">Faturamento</div><div class="val" id="k_fat">—</div><div class="sub">Anterior: <span id="p_fat">—</span></div><div class="delta flat" id="d_fat">—</div></div>
            <div class="kpi" data-kpi="ped"><div class="label">Pedidos</div><div class="val" id="k_ped">—</div><div class="sub">Anterior: <span id="p_ped">—</span></div><div class="delta flat" id="d_ped">—</div></div>
            <div class="kpi" data-kpi="tkt"><div class="label">Ticket Médio</div><div class="val" id="k_tkt">—</div><div class="sub">Anterior: <span id="p_tkt">—</span></div><div class="delta flat" id="d_tkt">—</div></div>
            <div class="kpi" data-kpi="des"><div class="label">Incentivos</div><div class="val" id="k_des">—</div><div class="sub">Anterior: <span id="p_des">—</span></div><div class="delta flat" id="d_des">—</div></div>
            <div class="kpi" data-kpi="desperc"><div class="label">% Incentivos</div><div class="val" id="k_desperc">—</div><div class="sub">Anterior: <span id="p_desperc">—</span></div><div class="delta flat" id="d_desperc">—</div></div>
            <div class="kpi" data-kpi="fre"><div class="label">Frete</div><div class="val" id="k_fre">—</div><div class="sub">Anterior: <span id="p_fre">—</span></div><div class="delta flat" id="d_fre">—</div></div>
          </section>
          <section class="panel">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title" id="title_month">Faturamento por mês — últimos 12M vs. 12M anteriores</h2>
                <div class="seg" id="segGlobal">
                  <button class="active" data-mode="total">Total</button>
                  <button data-mode="media">Média</button>
                </div>
              </div>
              <div class="chart-box"><canvas id="ch_month"></canvas></div>
            </div>
            <div class="side">
              <div class="card">
                <div class="card-header"><h2 class="card-title" id="title_top6">Participação por loja — Top 6 (Faturamento)</h2></div>
                <div class="donut-wrap">
                  <canvas id="ch_top6"></canvas>
                  <div id="top6Center" class="donut-center"></div>
                </div>
              </div>
            </div>
          </section>
          <section class="grid3">
            <div class="card"><div class="card-header"><h2 class="card-title" id="title_dow">Faturamento por dia da semana</h2></div><div class="chart-box"><canvas id="ch_dow"></canvas></div></div>
            <div class="card"><div class="card-header"><h2 class="card-title" id="title_hour">Faturamento por hora</h2></div><div class="chart-box"><canvas id="ch_hour"></canvas></div></div>
            <div class="card"><div class="card-header"><h2 class="card-title" id="title_turno">Faturamento por turno</h2></div><div class="chart-box"><canvas id="ch_turno"></canvas></div></div>
          </section>
        </div>
        <div class="tab" id="tab-analitico" style="display:none">
          <section class="kpi-grid">
              <div class="kpi" data-kpi="fatmed"><div class="label">Fat. Médio/Dia</div><div class="val" id="k_fatmed">—</div><div class="sub">Anterior: <span id="p_fatmed">—</span></div><div class="delta flat" id="d_fatmed">—</div></div>
              <div class="kpi" data-kpi="roi"><div class="label">ROI</div><div class="val" id="k_roi">—</div><div class="sub">Anterior: <span id="p_roi">—</span></div><div class="delta flat" id="d_roi">—</div></div>
              <div class="kpi" data-kpi="fremed"><div class="label">Frete Médio</div><div class="val" id="k_fremed">—</div><div class="sub">Anterior: <span id="p_fremed">—</span></div><div class="delta flat" id="d_fremed">—</div></div>
              <div class="kpi" data-kpi="canc_ped"><div class="label">Pedidos Canc.</div><div class="val" id="k_canc_ped">—</div><div class="sub">Anterior: <span id="p_canc_ped">—</span></div><div class="delta flat" id="d_canc_ped">—</div></div>
              <div class="kpi" data-kpi="canc_val"><div class="label">Valor Canc.</div><div class="val" id="k_canc_val">—</div><div class="sub">Anterior: <span id="p_canc_val">—</span></div><div class="delta flat" id="d_canc_val">—</div></div>
          </section>
          <section class="kpi-select-bar">
            <label for="kpi-select">Analisar KPI:</label>
            <select id="kpi-select" class="fx-select">
                <option value="fat" selected>Faturamento</option><option value="ped">Pedidos</option><option value="tkt">Ticket Médio</option><option value="des">Incentivos</option><option value="desperc">% Incentivos</option><option value="fre">Frete</option>
            </select>
          </section>
          <section class="panel">
            <div class="card card-hero" id="hero_main_kpi">
              <div class="hero-header">
                <h2 class="hero-title">Total Geral (Faturamento)</h2>
                <div class="delta flat">...</div>
              </div>
              <div class="hero-value"><span class="hero-value-number">—</span></div>
              <div class="hero-sub-value">Anterior: —</div>
            </div>
            <div class="side">
                <div class="card unit-kpi" id="unit-kpi-raja">
                    <div class="unit-kpi-header"><h3 class="unit-kpi-title">Uni.Raja</h3><div class="delta flat">...</div></div>
                    <div class="unit-kpi-value">—</div><div class="unit-kpi-sub">Anterior: —</div>
                </div>
                <div class="card unit-kpi" id="unit-kpi-savassi">
                    <div class="unit-kpi-header"><h3 class="unit-kpi-title">Uni.Savassi</h3><div class="delta flat">...</div></div>
                    <div class="unit-kpi-value">—</div><div class="unit-kpi-sub">Anterior: —</div>
                </div>
            </div>
          </section>
        </div>
        <div class="tab" id="tab-diagnostico" style="display:none">
          <section class="proj-grid">
            <div class="card">
              <h3 id="proj_total_label">PROJEÇÃO FATURAMENTO (30D)</h3>
              <div class="proj-val" id="proj_total_val">—</div>
              <div class="delta flat" id="proj_total_delta">—</div>
              <div class="seg" id="segProj">
                <button data-days="7">7D</button><button class="active" data-days="30">30D</button><button data-days="90">90D</button>
              </div>
            </div>
            <div class="card">
              <h3 id="proj_raja_label">UNI.RAJA - Faturamento</h3><div class="proj-val" id="proj_raja_val">—</div><div class="delta flat" id="proj_raja_delta">—</div>
            </div>
            <div class="card">
              <h3 id="proj_savassi_label">UNI.SAVASSI - Faturamento</h3><div class="proj-val" id="proj_savassi_val">—</div><div class="delta flat" id="proj_savassi_delta">—</div>
            </div>
          </section>
          <section class="panel">
            <div class="card">
              <div class="card-header">
                <h2 class="card-title">Análise de Performance</h2>
                <div class="seg" id="segDiagCharts">
                  <button class="active" data-mode="total">Total</button><button data-mode="media">Média</button><button data-mode="ped">Pedidos</button>
                </div>
              </div>
              <div class="hero-context"><strong>Destaques:</strong> Carregando...</div>
              <div class="grid3">
                <div class="sub-chart"><div class="sub-chart-title" id="diag_title_month">Faturamento por Mês</div><div class="chart-box"><canvas id="diag_ch_month"></canvas></div></div>
                <div class="sub-chart"><div class="sub-chart-title" id="diag_title_dow">Faturamento por Dia da Semana</div><div class="chart-box"><canvas id="diag_ch_dow"></canvas></div></div>
                <div class="sub-chart"><div class="sub-chart-title" id="diag_title_hour">Faturamento por Hora</div><div class="chart-box"><canvas id="diag_ch_hour"></canvas></div></div>
              </div>
            </div>
            <div class="side">
              <div class="card">
                <div class="card-header"><h2 class="card-title">Insights de IA</h2></div>
                <div class="ins-list" id="ins-list"></div>
              </div>
            </div>
          </section>
        </div>
      </div>
      <div class="footer">
        <div id="uploadInfo" class="upload-info"></div>
        <button id="btnUpload" class="btn-upload">Importar</button>
      </div>
    </main>
    <div class="filters">
      <header class="fx-header">
        <h2 class="fx-title">Filtros</h2>
        <div class="fx-actions">
          <button id="fxBtnReset" class="btn-subtle">Limpar</button>
          <button id="fxBtnMore" class="btn-subtle">Período</button>
        </div>
      </header>
      <div id="fxDropup" class="fx-dropup">
        <div class="fx-dropup-header"><h3 class="fx-dropup-title">Selecionar Período</h3><button id="fxDuClose" class="btn-icon">&times;</button></div>
        <div class="fx-dropup-content">
          <div class="fx-period-line">
            <div class="fx-field"><label class="fx-label" for="fxDuStart">De</label><input type="date" id="fxDuStart" class="fx-input"></div>
            <div class="fx-sep">→</div>
            <div class="fx-field"><label class="fx-label" for="fxDuEnd">Até</label><input type="date" id="fxDuEnd" class="fx-input"></div>
            <div class="fx-quickwrap">
              <div class="fx-quick-hint">Rápido:</div>
              <div id="fxDuQuickDays" class="fx-seg">
                <button data-win="7">7D</button><button data-win="15">15D</button><button data-win="30" class="fx-active">30D</button><button data-win="90">90D</button>
              </div>
            </div>
          </div>
          <div id="fxQuickChips" class="fx-chips">
            <button class="fx-chip" data-win="today">Hoje</button><button class="fx-chip" data-win="yesterday">Ontem</button><button class="fx-chip" data-win="lastMonth">Mês Passado</button><button class="fx-chip" data-win="lastYear">Ano Passado</button>
          </div>
        </div>
      </div>
      <section class="fx-body"><div class="fx-grid"><div class="fx-field"><label class="fx-label">Unidade</label><div id="fxUnit" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Loja</label><div id="fxStore" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Turno</label><div id="fxShift" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Canal</label><div id="fxChannel" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Forma de Pagamento</label><div id="fxPay" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Cancelado</label><select id="fxCanceled" class="fx-select"><option value="nao" selected>Não</option><option value="sim">Sim</option><option value="ambos">Ambos</option></select></div></div></section>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" crossorigin="anonymous"></script>
  <script src="estoque_dash_vendas_app.js"></script>
</body>
</html>
