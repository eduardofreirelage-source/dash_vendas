/* ===================== ESTILOS ENCAPSULADOS (v10.8) ===================== */

/* Define o escopo principal do componente. */
.dash-pratos-v10 {
    /* Variáveis CSS Isoladas no Escopo do Dashboard */
    --bg:#f7f7fa; --card:#ffffff; --ink:#0f172a; --muted:#64748b; --line:#e5e7eb;
    --wine:#7b1e3a; --wine-2:#8c2947; --chip:#fef2f2; --ok:#0b5d47; --down:#ef4444;
    --c-now:#7b1e3a; --c-prev:#9ca3af;

    /* Reset Básico e Fonte Padrão para o Dashboard */
    font: 11px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    color: var(--ink);
    background: var(--bg);
    
    /* v10.8: Layout Defensivo. Comporta-se como um bloco padrão. 
       Removemos display: flex, flex: 1, min-height, e overflow: hidden do root.
       Isso permite que a aplicação hospedeira controle o layout do dashboard sem conflitos. */
    display: block;
}

/* Aplica box-sizing a todos os elementos dentro do dashboard */
.dash-pratos-v10 * {
    box-sizing: border-box;
}

/* Layout Principal (Prefixado com dp-) */
/* v10.8: Simplificado para fluxo padrão */
.dp-wrap{display:flex;flex-direction:column;}
/* O main agora permite o scroll natural da página se o conteúdo exceder a altura. */
.dp-main{min-width:0;display:flex;flex-direction:column; padding-bottom: 60px;} /* Padding para evitar que o footer fixo cubra conteúdo */

.dp-top{position:sticky;top:0;z-index:10;background:var(--card);padding:10px 14px;border-bottom:1px solid var(--line);display:flex;align-items:center;gap:16px;margin-bottom:8px;justify-content:space-between}
.dp-brand{display:flex;align-items:center;gap:10px; font-size:16px; font-weight: 700; color: var(--ink);}
.dp-section{order:2;padding:0 16px 12px 16px}

/* KPIs (Prefixado com dp-) */
.dp-kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-bottom:12px}
.dp-kpi{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px;transition:.2s;position:relative}
.dp-kpi h4{margin:0 0 4px 0;color:var(--muted);font-size:11px;display:flex;align-items:center;gap:6px;}
.dp-kpi h4 .spacer { flex-grow: 1; }
.dp-kpi .val{font-size:22px;font-weight:500;letter-spacing:-.5px; color: var(--ink);}
.dp-kpi .sub{font-size:10px;color:var(--muted);margin-top:4px}

/* Delta Indicators (Prefixado com dp-) */
.dp-delta{display:inline-flex;gap:4px;align-items:center;padding:1px 6px;border-radius:999px;border:1px solid rgba(148,163,184,.35);font-weight:700;font-size:10px;margin-left:6px;background:rgba(148,163,184,.15);color:#6b7280}
.dp-delta.up{background:rgba(123,30,58,.10);border-color:rgba(123,30,58,.25);color:var(--wine)}
.dp-delta.down{background:rgba(239, 68, 68, 0.1); border-color: rgba(239, 68, 68, 0.25); color: var(--down); }

/* Charts e Cards (Prefixado com dp-) */
.dp-charts-grid{display:grid; grid-template-columns: repeat(2, 1fr); gap: 10px; flex: 1;}
.dp-card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px;display:flex;flex-direction:column; min-height: 200px; }
.dp-card .head{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px; flex-shrink: 0;}
.dp-title{font-weight:700; color: var(--ink)}
.dp-seg{display:inline-flex;border:1px solid var(--line);border-radius:8px;overflow:hidden}
.dp-seg button{padding:4px 8px;border:0;background:#fff;font-weight:700;color:#475569;cursor:pointer; font-size: 10px;}
.dp-seg button.active{background:var(--wine);color:#fff}
.dp-chart-box{position:relative;flex-grow:1;min-height:180px;}
.dp-chart-box canvas{display:block;width:100%;height:100%}
.dp-chart-message { position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; color: var(--muted); text-align: center; padding: 16px; background: rgba(255,255,255,0.8); }

/* Media Queries (Aplicadas ao componente) */
@media (max-width:1200px){ .dp-kpis{grid-template-columns:repeat(2,1fr)} .dp-charts-grid{grid-template-columns:1fr} }
@media (max-width: 768px) { .dp-kpis{ grid-template-columns: 1fr; } .dp-top { flex-direction: column; align-items: flex-start; } }

/* Spinner (Prefixado com dp-) */
.dp-spinner { animation: dp-spin 1s linear infinite; }
@keyframes dp-spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

/* LAYOUT DO TOP 10 (Prefixado com dp-) */
.dp-top10-header-row, .dp-top10-row { display: flex; align-items: center; padding: 0 8px; flex-shrink: 0; }
.dp-top10-header-row { font-size: 10px; font-weight: 700; color: var(--muted); text-transform: uppercase; border-bottom: 1px solid var(--line); padding-bottom: 6px; margin-bottom: 2px; }
.dp-top10-list-body { display: flex; flex-direction: column; flex-grow: 1; min-height: 0; }
.dp-top10-row { flex-grow: 1; border-bottom: 1px solid #f0f2f5; font-size: 11px; }
.dp-top10-row:last-child { border-bottom: none; }
.dp-top10-col-rank { flex: 0 0 30px; font-weight: 700; text-align: center; color: var(--muted); }
.dp-top10-col-prato { flex: 1 1 auto; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-weight: 500; padding-right: 8px; }
.dp-top10-col-qty { flex: 0 0 50px; text-align: right; font-weight: 700; }


/* ===================== Estilos dos Filtros (FX) e Multi-Select (MSel) ===================== */

/* v10.8: Barra de filtros posicionada de forma fixa em relação ao viewport para máxima usabilidade */
.fx-filters-bar{ position:fixed; left:0; right:0; bottom:0; z-index:1000; background:#fff; border-top:1px solid var(--line); padding:8px 14px; height:56px; display:flex; align-items:center; justify-content:space-between; }

.fx-fb-left{display:flex; align-items:center; gap:10px; min-width:0; flex:1}
.fx-fb-label{font-weight:700; color:var(--ink); font-size:12px; white-space:nowrap;}
.fx-chips{display:flex; gap:8px; overflow:auto; scrollbar-width:none}
.fx-chips::-webkit-scrollbar{display:none}
.fx-chip{flex:0 0 auto; padding:6px 12px; border:1px solid var(--line); border-radius:8px; background:#fff; color:#334155; font-weight:700; cursor:pointer; font-size:11px}
.fx-chip.active{background:var(--wine); color:#fff; border-color:var(--wine)}
.fx-fb-right{display:flex; align-items:center; gap:8px}
.fx-iconbtn{display:inline-flex; align-items:center; justify-content:center; width:36px; height:36px; border:1px solid var(--line); border-radius:8px; background:#fff; cursor:pointer}
.fx-textbtn{padding:8px 14px; border:1px solid var(--line); background:#fff; color:#334155; border-radius:8px; font-weight:700; cursor:pointer; font-size:11px; display: inline-flex; align-items: center; gap: 6px;}

/* Dropup (Posicionamento fixo em relação ao viewport) */
.fx-dropup{ position:fixed; left:8px; right:8px; bottom:60px; z-index:1010; background:#fff; border:1px solid var(--line); border-radius:12px; box-shadow:0 16px 40px rgba(0,0,0,.08); padding:0; display:none; max-height: 80vh; overflow-y: auto; }
.fx-dropup.fx-show{display:block; animation:fx-pop .15s ease-out}
@keyframes fx-pop{from{transform:translateY(8px);opacity:0}to{transform:translateY(0);opacity:1}}
.fx-du-head{position:sticky; top:0; background:#fff; border-bottom:1px solid var(--line); padding:8px 10px; display:flex; align-items:center; justify-content:space-between; border-top-left-radius:12px; border-top-right-radius:12px}
.fx-du-title{font-weight:900; color:#334155; font-size:12px}
.fx-du-body{padding:10px 10px; display:flex; flex-direction:column; gap:10px;}
.fx-du-sec{display:flex; flex-direction:column; gap:8px}
.fx-du-sec + .fx-du-sec{padding-top:8px; border-top:1px dashed var(--line)}
.fx-du-sec h4{margin:0; font-size:11.5px; letter-spacing:.2px; text-transform:uppercase; color:#475569}
.fx-du-grid{display:grid; grid-template-columns:repeat(12,1fr); gap:8px; align-items:end}
.fx-field{display:flex; flex-direction:column; gap:4px; min-width:0}
.fx-label{font-size:10px; color:#64748b}
.fx-input{ height:30px; padding:4px 8px; border:1px solid var(--line); border-radius:8px; background:#fff; font:inherit }
.fx-period-line{ display:grid; grid-template-columns: 1fr 1fr auto; gap: 12px; align-items: end; }
.fx-seg{border-radius:10px; display:inline-flex; border:1px solid var(--line); background:#fff; white-space:nowrap; overflow:hidden}
.fx-seg button{ height:30px; min-width:44px; padding:0 10px; border:0; background:transparent; cursor:pointer; font-weight:800; color:#475569; font-size:10px }
.fx-seg button.fx-active{background:var(--wine); color:#fff}

/* Estilos para MultiSelect (msel) */
.msel{position:relative}
.msel-btn{width:100%; text-align: left; height:30px; padding:4px 8px; border:1px solid var(--line); border-radius:8px; background:#fff; font:inherit; cursor: pointer; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}
.msel-btn:after{content:"▾";float:right;color:#475569; margin-left: 8px;}
.msel-panel{position:absolute;z-index:1015;bottom:110%;left:0;right:0;background:#fff;border:1px solid var(--line);border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,.08);max-height:250px;overflow:hidden;padding:8px;display:none; flex-direction: column;}
.msel.open .msel-panel{display:flex}
.msel-search{width:100%;padding:8px 10px;border:1px solid var(--line);border-radius:8px;margin-bottom:8px; flex-shrink: 0; font-size: 11px;}
.msel-options-list { overflow-y: auto; flex-grow: 1; }
.msel-opt{display:flex;align-items:center;gap:8px;padding:5px 6px;border-radius:6px; cursor: pointer; font-size: 11px;}
.msel-opt:hover{background:#f3f4f6}
.msel-opt input[type="checkbox"] { margin: 0; flex-shrink: 0; cursor: pointer; }
.msel-opt span { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
