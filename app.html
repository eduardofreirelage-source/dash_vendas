<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width,initial-scale=1" name="viewport"/>
    <title>Mapa de Produção — v3.5 Final</title>
    <link href='data:image/svg+xml,&lt;svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"&gt;&lt;rect x="0" y="0" width="128" height="128" rx="22" fill="%237b1e3a"/&gt;&lt;text x="64" y="78" text-anchor="middle" font-family="Arial" font-size="56" fill="white"&gt;MP&lt;/text&gt;&lt;/svg&gt;' rel="icon"/>
    <link rel="stylesheet" href="estoque_styles.css">
</head>
<body>
<main class="main">
    <div class="top">
        <div class="brand">
        <div class="logo">MP</div>
        <div>
        <h1 style="font-size:18px; margin:0; line-height:1.2">Mapa de Produção</h1>
        <div class="hint" style="margin:0">Ficha técnica, previsão e compras</div>
        </div>
        </div>
        <nav class="tabs" id="main-tabs">
        <button class="active" data-tab="cadastros">Cadastros</button>
        <button data-tab="producao">Produção</button>
        <button data-tab="compras">Compras</button>
        <button data-tab="estoque">Estoque</button>
        </nav>
        <div class="status-bar">
        <div id="status">Carregando…</div>
        </div>
    </div>

    <div class="content-wrap">
    <section class="tab-content active" id="tab-cadastros">
        <div class="section" id="section-cadastros">
            <nav class="subtabs" id="cadastro-subtabs">
                <button class="active" data-subtab="pratos">Pratos</button>
                <button data-subtab="componentes">Componentes</button>
                <button data-subtab="receitas">Receitas</button>
                <button data-subtab="ingredientes">Ingredientes</button>
                <button class="chip" data-subtab="um">Unidades de Medida</button>
                <button class="chip" data-subtab="unidades">Unidades (destino)</button>
                <button class="chip" data-subtab="categorias">Categorias</button>
                <button class="chip" data-subtab="item-tipos">Tipos de Item</button>

            </nav>
            <div class="subpage active" id="sub-pratos">
                <div class="grid cols-2" style="align-items:flex-end;">
                    <div><input id="pratos-search" placeholder="Buscar prato cadastrado..."/></div>
                    <div><label>Filtrar categoria</label>
                        <select id="pratos-cat-filter"><option value="">Todas</option><option>PRATOS</option><option>ACOMPANHAMENTOS</option><option>BEBIDAS</option><option>SOBREMESA</option><option>PROMOÇÕES</option><option>OUTROS</option></select>
                    </div>
                </div>
                 <div class="sep"></div>
                <div class="grid cols-2" style="margin:6px 0; align-items:flex-end;">
                    <div class="right" style="justify-content:start;"><button class="btn pri" id="btnNovoPrato">+ Novo prato</button></div>
                    <div class="right">
                        <span class="pill" id="pratos-page-info">Página 1/1</span>
                        <div class="row-actions"><button class="btn small" id="pratos-prev">◀</button><button class="btn small" id="pratos-next">▶</button></div>
                    </div>
                </div>
                <div class="table-container" style="max-height:420px;">
                    <table id="tblPratos"><thead><tr><th>Nome</th><th>Categoria</th><th>Receitas</th><th>Ativo</th><th>Ações</th></tr></thead><tbody></tbody></table>
                </div>
                <div class="sep"></div>
                <div class="editor-container" id="prato-editor-container">
                    <h3 id="prato-form-title">Novo Prato</h3>
                    <div class="grid cols-4">
                    <div><label>Nome</label><input id="prato-nome" placeholder="Ex.: Strogonoff de frango"/></div>
                    <div><label>Categoria</label><select id="prato-cat"><option>PRATOS</option><option>ACOMPANHAMENTOS</option><option>BEBIDAS</option><option>SOBREMESA</option><option>PROMOÇÕES</option><option>OUTROS</option></select></div>
                    <div><label>Peso do prato</label><select id="prato-peso-un"><option>g</option><option>ml</option></select></div>
                    <div><label>Qtd</label><input id="prato-peso" placeholder="Ex.: 500"/></div>
                    </div>
                    <div class="grid cols-2" style="margin-top:10px;">
                    <div><label>Cód. Barras</label><input disabled="" id="prato-codigo-barras"/></div>
                    <div><label>QR Code</label><input disabled="" id="prato-qrcode"/></div>
                    </div>
                    <div style="margin-top:10px;">
                    <label>Descrição para o cardápio</label>
                    <textarea id="prato-descricao" placeholder="Descreva o prato para seus clientes... ou deixe que a IA sugira!" rows="3"></textarea>
                    </div>
                    <div class="grid cols-4" style="margin-top:10px; align-items:flex-end;">
                    <div><label>Preço de venda (fator ou R$)</label><input id="prato-preco" placeholder="Ex.: 3,2 (fator) ou 34,90 (R$)"/></div>
                    <div><label>Custo do prato (calculado)</label><input disabled="" id="prato-custo" placeholder="R$ 0,00"/></div>
                    <div><label>Última alteração</label><input disabled="" id="prato-ultima" placeholder="—"/></div>
                    <div class="right">
                    <button class="btn" id="btnGenerateDesc">✨ Sugerir (IA)</button>
                    <button class="btn pri" id="btnSalvarPrato">Salvar</button>
                    <button class="btn" id="btnCancelarPrato">Cancelar</button>
                    </div>
                    </div>
                </div>
                <details class="dash" id="dash-import">
                <summary>Importar Pratos do Dashboard (clique para expandir)</summary>
                <div class="grid cols-3" style="margin-top:10px; align-items:flex-end;">
                <div><label>Categoria (da fonte)</label><select id="dash-cat"><option value="">Sem categoria</option><option>PRATOS</option><option>ACOMPANHAMENTOS</option><option>BEBIDAS</option><option>SOBREMESA</option><option>PROMOÇÕES</option><option>OUTROS</option></select></div>
                <div><label>Buscar no dashboard</label><input id="dash-search" placeholder="Digite para filtrar…"/></div>
                <div class="right">
                    <button class="btn" id="btnSyncAll">Buscar</button>
                    <button class="btn pri" id="btnImportAll">Importar Visíveis</button>
                </div>
                </div>
                <div class="table-container" style="overflow:auto;margin-top:10px;max-height:300px;">
                <table id="tblDash"><thead><tr><th>Prato (dashboard)</th><th>Categoria</th><th>Situação</th><th>Ação</th></tr></thead><tbody></tbody></table>
                </div>
                </details>
            </div>
            <div class="subpage" id="sub-componentes">
                <h2>Componentes do Prato</h2>
                <div class="grid cols-2">
                <div>
                <label>Selecione um prato para ver ou adicionar componentes</label>
                <select id="cp-prato"><option value="">Selecione...</option></select>
                </div>
                </div>
                <div id="componentes-editor" style="display: none;">
                <div class="sep"></div>
                <h4>Adicionar Nova Receita ao Prato</h4>
                <div class="grid cols-4">
                <div><label>Receita</label><select id="cp-receita"></select></div>
                <div><label>Qtd por prato</label><input id="cp-qtd" placeholder="Ex.: 220"/></div>
                <div><label>Unidade</label><select id="cp-und"><option>g</option><option>ml</option><option>porcao</option></select></div>
                <div class="right" style="align-self: flex-end;">
                <button class="btn pri" id="btnAddPrComp">Adicionar</button>
                </div>
                </div>
                <div class="grid cols-2" style="margin-top:10px; align-items:flex-end;">
                <div><label>Observações</label><input id="cp-obs" placeholder="Opcional"/></div>
                </div>
                <div class="sep"></div>
                <h4>Receitas Atuais do Prato</h4>
                <div class="table-container" style="max-height:420px"><table id="tblPrComp"><thead><tr><th>Receita</th><th>Qtd</th><th>Un</th><th>Ações</th></tr></thead><tbody></tbody></table></div>
                </div>
            </div>
            <div class="subpage" id="sub-receitas">
                <div class="right" style="margin-bottom: 16px;">
                <button class="btn pri" id="btnShowNewRecipeForm">+ Nova Receita</button>
                </div>
                <div class="editor-container" id="recipe-editor-container">
                <h3 id="recipe-form-title">Nova Receita</h3>
                <div class="grid cols-3">
                <div><label>Nome da receita</label><input id="rec-nome" placeholder="Ex.: Arroz Branco pronto"/></div>
                <div><label>Rendimento (qtd)</label><input id="rec-rend-qtd" placeholder="Ex.: 1000"/></div>
                <div><label>Unidade rendimento</label><select id="rec-rend-und"><option>g</option><option>kg</option><option>ml</option><option>L</option><option value="porcao">porção</option></select></div>
                </div>
                <div class="grid cols-3" style="margin-top:10px;">
                <div><label>Perda global (%)</label><input id="rec-perda" value="0"/></div>
                <div><label>Cód. Barras</label><input disabled="" id="rec-codigo-barras"/></div>
                <div><label>QR Code</label><input disabled="" id="rec-qrcode"/></div>
                </div>
                <div><label>Observações</label><input id="rec-obs" placeholder="Opcional"/></div>
                <div style="margin-top:10px;">
                <label>Modo de Preparo</label>
                <textarea id="rec-preparo" placeholder="Descreva o passo-a-passo ou clique para gerar..." rows="6"></textarea>
                </div>
                <div class="sep"></div>
                <h4>Itens da Receita</h4>
                <div class="grid cols-4">
                <div><label>Tipo</label><select id="draft-tipo"><option>INGREDIENTE</option><option>RECEITA</option></select></div>
                <div><label>Referência</label><select id="draft-ref"></select></div>
                <div><label>Qtd</label><input id="draft-qtd" placeholder="Ex.: 300"/></div>
                <div><label>Unidade</label><select id="draft-und"><option>g</option><option>kg</option><option>ml</option><option>L</option><option>un</option></select></div>
                </div>
                <div class="grid cols-2" style="margin-top:10px; align-items:flex-end;">
                <div><label>Perda da linha (%)</label><input id="draft-perda" value="0"/></div>
                <div class="right">
                <button class="btn" id="btnDraftAdd">Adicionar Item</button>
                <button class="btn" id="btnDraftClear">Limpar Itens</button>
                </div>
                </div>
                <div class="table-container" style="margin-top:8px;max-height:200px"><table id="tblDraft"><thead><tr><th>Tipo</th><th>Nome</th><th>Qtd</th><th>Un</th><th>Perda%</th><th>Ações</th></tr></thead><tbody></tbody></table></div>
                <div class="sep"></div>
                <div class="right">
                <button class="btn" id="btnGeneratePreparo">✨ Gerar Preparo (IA)</button>
                <button class="btn pri" id="btnSaveRec">Salvar</button>
                <button class="btn pri" id="btnUpdateRec" style="display:none">Atualizar</button>
                <button class="btn" id="btnCancelRecEdit">Cancelar</button>
                </div>
                </div>
                <h3>Receitas Cadastradas</h3>
                <div class="table-container">
                <table id="tblRec"><thead><tr><th>Nome</th><th>Rendimento</th><th>Itens</th><th>Ativo</th><th>Ações</th></tr></thead><tbody></tbody></table>
                </div>
            </div>
            <div class="subpage" id="sub-ingredientes">
                <div class="right" style="margin-bottom: 16px;">
                    <button class="btn pri" id="btnShowNewIngredienteForm">+ Novo Ingrediente</button>
                </div>
                <div class="editor-container" id="ingrediente-editor-container">
                    <h3 id="ingrediente-form-title">Novo Ingrediente</h3>
                    <div class="grid cols-4">
                        <div><label>Nome</label><input id="ing-nome" placeholder="Ex.: Arroz branco cru"/></div>
                        <div><label>Categoria</label><select id="ing-categoria"><option>Alimentos</option><option>Bebidas</option><option>Descartáveis</option><option>Proteínas</option><option>Outros</option></select></div>
                        <div><label>Unidade de Medida</label><select id="ing-unidade-medida"></select></div>
                        <div><label>Custo unitário</label><input id="ing-custo" placeholder="Ex.: 0,0123"/></div>
                    </div>
                    <div class="sep"></div>
                    <div class="grid cols-4">
                         <div><label>Estoque Mínimo</label><input id="ing-estoque-min" placeholder="0" type="number"/></div>
                         <div><label>Estoque Máximo</label><input id="ing-estoque-max" placeholder="0" type="number"/></div>
                         <div><label>Local de Armazenagem</label><select id="ing-local-armazenagem"></select></div>
                    </div>
                    <div class="sep"></div>
                    <div class="grid cols-2">
                        <div><label>Cód. Barras</label><input disabled id="ing-codigo-barras"/></div>
                        <div><label>QR Code</label><input disabled id="ing-qrcode"/></div>
                    </div>
                    <div style="margin-top:10px;"><label>Observações</label><input id="ing-obs" placeholder="Opcional"/></div>
                    <div class="right" style="margin-top:16px;">
                        <button class="btn pri" id="btnSaveIng">Salvar</button>
                        <button class="btn" id="btnCancelIngEdit">Cancelar</button>
                    </div>
                </div>
                <div class="grid cols-2">
                    <div class="pill">Ingredientes cadastrados</div>
                    <div class="right"><input id="ing-search" placeholder="Buscar..."/></div>
                </div>
                <div class="table-container" style="margin-top:6px;">
                    <table id="tblIng">
                        <thead><tr><th>Nome</th><th>Categoria</th><th>Unidade</th><th>Custo</th><th>Ativo</th><th>Ações</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="subpage" id="sub-um">
                <div class="right" style="margin-bottom: 16px;">
                    <button class="btn pri" id="btnShowNewUmForm">+ Nova Unidade de Medida</button>
                </div>
                <div class="editor-container" id="um-editor-container">
                    <h3 id="um-form-title">Nova Unidade de Medida</h3>
                    <form id="form-um">
                        <input name="id" type="hidden"/>
                        <div class="grid cols-3">
                            <div><label>Sigla</label><input maxlength="5" name="sigla" placeholder="KG" required=""/></div>
                            <div><label>Nome</label><input name="nome" placeholder="Quilograma" required=""/></div>
                            <div><label>Código</label><input name="codigo" placeholder="kg" required=""/></div>
                        </div>
                        <div class="grid cols-3" style="margin-top:10px;">
                             <div>
                                <label>Base</label>
                                <select name="base">
                                    <option value="g">g</option>
                                    <option value="ml">ml</option>
                                    <option value="un">un</option>
                                </select>
                            </div>
                            <div><label>Fator</label><input name="fator" step="0.000001" type="number" value="1"/></div>
                            <div style="align-self: flex-end;"><label><input checked name="ativo" type="checkbox"/> Ativo</label></div>
                        </div>
                        <div class="right" style="margin-top:16px;">
                            <button class="btn pri" type="submit">Salvar</button>
                            <button class="btn" id="btnCancelUmEdit" type="button">Cancelar</button>
                        </div>
                    </form>
                </div>
                <h3>Unidades de Medida Cadastradas</h3>
                <div class="table-container">
                    <table id="tbl-um">
                        <thead><tr><th>Sigla</th><th>Nome</th><th>Código</th><th>Base</th><th>Fator</th><th>Ativo</th><th>Ações</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="subpage" id="sub-unidades">
                <div class="right" style="margin-bottom: 16px;">
                    <button class="btn pri" id="btnShowNewUnidadesForm">+ Nova Unidade</button>
                </div>
                <div class="editor-container" id="unidades-editor-container">
                    <h3 id="unidades-form-title">Nova Unidade (destino)</h3>
                    <form id="form-unidades">
                        <input name="id" type="hidden"/>
                        <div class="grid cols-2">
                             <div><label>Nome</label><input name="nome" placeholder="Depósito X ou Loja Y" required=""/></div>
                             <div style="align-self: flex-end;"><label><input checked name="ativo" type="checkbox"/> Ativo</label></div>
                        </div>
                        <div class="right" style="margin-top:16px;">
                            <button class="btn pri" type="submit">Salvar</button>
                            <button class="btn" id="btnCancelUnidadesEdit" type="button">Cancelar</button>
                        </div>
                    </form>
                </div>
                <h3>Unidades (destino) Cadastradas</h3>
                <div class="table-container">
                    <table id="tbl-unidades">
                        <thead><tr><th>Nome</th><th>Ativo</th><th>Ações</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="subpage" id="sub-categorias">
                 <div class="right" style="margin-bottom: 16px;">
                    <button class="btn pri" id="btnShowNewCategoriasForm">+ Nova Categoria</button>
                </div>
                <div class="editor-container" id="categorias-editor-container">
                    <h3 id="categorias-form-title">Nova Categoria</h3>
                    <form id="form-categorias">
                        <input name="id" type="hidden"/>
                        <div class="grid cols-3">
                             <div><label>Nome</label><input name="nome" required=""/></div>
                             <div>
                                <label>Tipo</label>
                                <select name="tipo">
                                    <option value="INGREDIENTE">INGREDIENTE</option>
                                    <option value="PRATO">PRATO</option>
                                    <option value="COMPONENTE">COMPONENTE</option>
                                </select>
                             </div>
                             <div style="align-self: flex-end;"><label><input checked name="ativo" type="checkbox"/> Ativo</label></div>
                        </div>
                        <div class="right" style="margin-top:16px;">
                            <button class="btn pri" type="submit">Salvar</button>
                            <button class="btn" id="btnCancelCategoriasEdit" type="button">Cancelar</button>
                        </div>
                    </form>
                </div>
                <h3>Categorias Cadastradas</h3>
                 <div class="table-container">
                    <table id="tbl-categorias">
                        <thead><tr><th>Nome</th><th>Tipo</th><th>Ativo</th><th>Ações</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
            <div class="subpage" id="sub-item-tipos">
                <div class="right" style="margin-bottom: 16px;">
                    <button class="btn pri" id="btnShowNewItemTiposForm">+ Novo Tipo de Item</button>
                </div>
                <div class="editor-container" id="itemtipos-editor-container">
                     <h3 id="itemtipos-form-title">Novo Tipo de Item</h3>
                    <p class="muted" hidden="" id="itemtipos-warning">🚫 Tabela <code>item_tipos</code> / <code>tipos_item</code> não encontrada. Esta aba ficará somente leitura até você criar a tabela.</p>
                    <form id="form-itemtipos">
                        <input name="id" type="hidden"/>
                         <div class="grid cols-2">
                            <div><label>Nome</label><input name="nome" placeholder="Ex.: ING, PRATO, COMP" required=""/></div>
                            <div style="align-self: flex-end;"><label><input checked name="ativo" type="checkbox"/> Ativo</label></div>
                         </div>
                        <div class="right" style="margin-top:16px;">
                            <button class="btn pri" type="submit">Salvar</button>
                            <button class="btn" id="btnCancelItemTiposEdit" type="button">Cancelar</button>
                        </div>
                    </form>
                </div>
                <h3>Tipos de Item Cadastrados</h3>
                <div class="table-container">
                    <table id="tbl-itemtipos">
                        <thead><tr><th>Nome</th><th>Ativo</th><th>Ações</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>

        </div>
    </section>
    <section class="tab-content" id="tab-producao">
        <div class="section">
            <h2>Mapa de Produção – Previsão</h2>
            <div class="grid cols-4" style="align-items:flex-end;">
                <div><label>Média dos últimos (dias)</label><input id="win-dias" min="1" step="1" type="number" value="7"></div>
                <div><label>Projetar próximos (dias)</label><input id="proj-dias" min="1" step="1" type="number" value="7"></div>
                <div><label>Filtrar Categorias de Pratos</label><select id="cat-filter" multiple=""></select></div>
                <div class="right"><button class="btn pri" id="btnCalcularPrev">Calcular</button></div>
            </div>
            <div class="hint" id="prev-hint-top"></div>
            <div class="grid cols-3" style="margin-top:10px">
                <div class="pill"><span class="soft">Dias analisados:</span> <span id="kpi-dias" style="font-weight:600">—</span></div>
                <div class="pill"><span class="soft">Pratos considerados:</span> <span id="kpi-pratos" style="font-weight:600">—</span></div>
                <div class="pill"><span class="soft">Receitas consolidadas:</span> <span id="kpi-rec" style="font-weight:600">—</span></div>
            </div>
            <div class="sep"></div>
            <h3>Resumo — Média de Vendas por Prato</h3>
            <div class="table-container" style="max-height:300px;">
                <table id="tblResumoPratos"><thead><tr><th>Prato</th><th>Categoria</th><th>Média/Dia</th><th id="th-proj-prato">Projeção</th></tr></thead><tbody></tbody></table>
            </div>
            <div class="sep"></div>
            <h3>Produção consolidada por Receita</h3>
            <div class="table-container" style="max-height:360px;">
                <table id="tblPrev"><thead><tr><th>Receita</th><th>Un</th><th>Qtd/Dia</th><th id="th-proj">Qtd/Projeção</th></tr></thead><tbody></tbody></table>
            </div>
            <div class="right" style="margin-top:12px"><button class="btn" id="btnExportPrev">Exportar PDF</button></div>
            <div class="hint" id="prev-hint"></div>
        </div>
    </section>
    <section class="tab-content" id="tab-compras">
       <div class="section">
            <h3>Sugestões de Compra</h3>
            <div class="hint">Calculado com base no estoque atual, ponto de pedido, consumo médio e lead time.</div>
            <div class="right" style="margin: 16px 0;">
                <button class="btn" id="btnRefreshSuggestions">Atualizar Sugestões</button>
                <button class="btn" id="btnExportSuggestions">Exportar CSV</button>
            </div>
            <div class="table-container">
                <table id="tblSugestoes"><thead><tr><th>Item</th><th>Status</th><th>Saldo Atual</th><th>Ponto Pedido</th><th>Consumo Médio/Dia</th><th>Sugestão (Qtd)</th><th>Múltiplo Compra</th></tr></thead><tbody></tbody></table>
            </div>
        </div>
    </section>
    <section class="tab-content" id="tab-estoque">
        <div class="section" id="section-estoque">
            <nav class="subtabs" id="estoque-subtabs">
                <button class="active" data-subtab="estoque-visao">Visão Geral</button>
                <button data-subtab="estoque-mov">Movimentar</button>
                <button data-subtab="estoque-benef">Beneficiar</button>
                <button data-subtab="estoque-inv">Inventário</button>
                <button data-subtab="estoque-param">Parâmetros</button>
                <button data-subtab="estoque-anom">Anomalias (IA)</button>
            </nav>
            <div class="subpage active" id="sub-estoque-visao">
                <div class="grid cols-5">
                    <div class="pill bad">Críticos: <b id="estoq-kpi-criticos">0</b></div>
                    <div class="pill warn">Abaixo Mín.: <b id="estoq-kpi-min">0</b></div>
                    <div class="pill">Acima Máx.: <b id="estoq-kpi-max">0</b></div>
                    <div class="pill warn">Venc. &lt; 7d: <b id="estoq-kpi-venc7">0</b></div>
                    <div class="pill">Ajustes (30d): <b id="estoq-kpi-ajustes">R$ 0,00</b></div>
                </div>
                <div class="filters-bar">
                    <div><label>Filtrar por Local</label><select id="filtro-unidade-estoque"></select></div>
                    <div><label>Filtrar por Categoria</label><select id="filtro-categoria-estoque"></select></div>
                    <div><label>Filtrar por Status</label><select id="filtro-status-estoque"><option value="">Todos</option><option value="CRÍTICO">Crítico</option><option value="ABAIXO DO MÍNIMO">Abaixo do Mínimo</option><option value="OK">OK</option></select></div>
                </div>
                <h4>Saldo Atual por Item</h4>
                <div class="table-container" style="max-height: 250px;">
                    <table id="tblSaldo">
                        <thead>
                            <tr>
                                <th>Item</th>
                                <th>Tipo</th>
                                <th>Local</th>
                                <th>Saldo Atual</th>
                                <th>Un.</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
                <div class="sep"></div>
                <h4>Saldo Detalhado por Lote</h4>
                <div class="table-container" style="max-height: 250px;">
                <table id="tblSaldoLotes"><thead><tr><th>Item</th><th>Lote</th><th>Validade</th><th>Saldo</th><th>Unidade</th><th>Custo Unit.</th></tr></thead><tbody></tbody></table>
                </div>
            </div>
            <div class="subpage" id="sub-estoque-mov">
                <h3>Operações de Estoque</h3>
                <div class="mov-actions">
                <button class="btn" data-mov-type="ENTRADA"><span>📥</span> Entrada</button>
                <button class="btn" data-mov-type="SAIDA"><span>📤</span> Saída</button>
                <button class="btn" data-mov-type="TRANSFERENCIA"><span>🔄</span> Transferência</button>
                <button class="btn" data-mov-type="AJUSTE"><span>✍️</span> Ajuste</button>
                </div>
                <div id="mov-form-container">
                <h3 id="mov-form-title"></h3>
                <form id="frmMov">
                <div class="grid cols-2">
                <div id="mov-unidade-origem-group"><label>Unidade Origem</label><select id="mov-unidade-origem"></select></div>
                <div id="mov-unidade-destino-group"><label>Unidade Destino</label><select id="mov-unidade-destino"></select></div>
                </div>
                <div class="grid cols-2" style="margin-top:10px">
                <div><label>Item</label><select id="mov-item"></select></div>
                <div><label>Tipo Item</label><select id="mov-item-tipo"><option value="ING">Ingrediente</option><option value="REC">Receita</option></select></div>
                </div>
                <div class="grid cols-2" style="margin-top:10px">
                <div><label>Lote</label><input id="mov-lote" placeholder="Lote do produto"/></div>
                <div id="mov-validade-group"><label>Validade</label><input id="mov-validade" type="date"/></div>
                </div>
                <div class="grid cols-3" style="margin-top:10px">
                <div><label>Quantidade</label><input id="mov-qtd" placeholder="0,00" type="number"/></div>
                <div id="mov-ajuste-sinal-group"><label>Tipo de Ajuste</label><select id="mov-ajuste-sinal"><option value="+">Positivo (+)</option><option value="-">Negativo (-)</option></select></div>
                <div><label>Un. Medida</label><input id="mov-un" placeholder="kg, L, un"/></div>
                </div>
                <div id="mov-custo-group" style="margin-top:10px"><label>Custo Unitário</label><input id="mov-custo" placeholder="0,00" type="number"/></div>
                <div style="margin-top:10px"><label>Documento/Observação</label><input id="mov-doc" placeholder="Nota Fiscal, Motivo, etc."/></div>
                <div class="right" style="margin-top:16px;">
                <button class="btn" id="btnMovScan" type="button">📷 Scan QR</button>
                <button class="btn pri" id="btnMovSubmit" type="submit">Registrar</button>
                <button class="btn" id="btnMovCancel" type="button">Cancelar</button>
                </div>
                </form>
                <video id="qr-video"></video>
                <div class="hint" id="qr-result" style="margin-top: 8px;"></div>
                </div>
                <div class="sep"></div>
                <h4>Últimas 20 Movimentações</h4>
                <div class="table-container" style="max-height: 300px;">
                <table id="tblMovRecentes"><thead><tr><th>TS</th><th>Tipo</th><th>Item</th><th>Qtd</th><th>Unidade</th></tr></thead><tbody></tbody></table>
                </div>
            </div>
            <div class="subpage" id="sub-estoque-param">
                <h3>Parâmetros de Estoque por Ingrediente</h3>
                <div class="table-container">
                    <table id="tbl-estoque-params">
                        <thead>
                            <tr>
                                <th>Ingrediente</th>
                                <th>Estoque Mínimo</th>
                                <th>Estoque Máximo</th>
                                <th>Unidade</th>
                                <th>Local de Armazenagem</th>
                                <th>Ações</th>
                            </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
             </div>
    </section>
    </div>
</main>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
<script src="estoque_app.js"></script>
</body>
</html>
