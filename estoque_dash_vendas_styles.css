:root{
    --bg:#f7f7fa; --card:#ffffff; --ink:#0f172a; --muted:#64748b; --line:#e5e7eb;
    --wine:#7b1e3a; --wine-2:#8c2947; --chip:#fef2f2; --ok:#0b5d47; --down:#b91c1c;
    --c-now:#7b1e3a; --c-prev:#9ca3af;
    --ok-dark: #065f46;
    --wine-dark: #881337;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--ink);font:11px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}
.wrap{display:flex;flex-direction:column;min-height:100vh}

/* MAIN HEADER + LAYOUT */
.main{flex:1;min-width:0;display:flex;flex-direction:column}
.top{position:sticky;top:0;z-index:10;background:var(--card);padding:10px 14px;border-bottom:1px solid var(--line);display:flex;align-items:center;gap:12px;margin-bottom:8px;justify-content:space-between}
.brand{display:flex;align-items:center;gap:10px}
.tabs{display:flex;gap:6px;border:0;background:transparent}
.tabs button{padding:6px 8px;border:0;background:transparent;font-weight:700;color:#334155;cursor:pointer;border-radius:8px;position:relative}
.tabs button.active{background:transparent;color:var(--wine)} .tabs button.active::after{content:"";position:absolute;left:6px;right:6px;bottom:-8px;height:3px;border-radius:2px;background:var(--wine)}
.upload-bar { display: flex; align-items: center; gap: 12px; }
.filter-toggle{display:none}

/* GRID DECISÃO */
.section{order:2;padding:0 16px 16px 16px}
.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:12px}
.kpi{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px;transition:.2s;position:relative; cursor:pointer;}
.kpi.active{outline:3px solid rgba(123,30,58,.12);border-color:var(--wine)}
.kpi h4{margin:0 0 4px 0;color:var(--muted);font-size:12px;display:flex;align-items:center;gap:6px;}
.kpi h4 .spacer { flex-grow: 1; }
.kpi .val{font-size:22px;font-weight:500;letter-spacing:-.5px}
.kpi .sub{font-size:11px;color:var(--muted);margin-top:4px}
.kpi[data-kpi="fat"] .val { color: var(--c-now); }
.delta{display:inline-flex;gap:4px;align-items:center;padding:1px 6px;border-radius:999px;border:1px solid rgba(148,163,184,.35);font-weight:700;font-size:10px;margin-left:6px;background:rgba(148,163,184,.15);color:#6b7280}
.delta svg{width:10px;height:10px}
.delta.up{background:rgba(6,95,70,.1);border-color:rgba(6,95,70,.25);color:var(--ok-dark)}
.delta.down{background:rgba(136,19,55,.1);border-color:rgba(136,19,55,.25);color:var(--wine-dark)}

.panel{display:grid;grid-template-columns:1fr 260px;gap:8px; align-items: start;}
.card{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:8px;display:flex;flex-direction:column;}
.card .head{display:flex;justify-content:space-between;align-items:center;margin-bottom:6px}
.title{font-weight:700}
.seg{display:inline-flex;border:1px solid var(--line);border-radius:8px;overflow:hidden}
.seg button{padding:5px 9px;border:0;background:#fff;font-weight:700;color:#475569;cursor:pointer}
.seg button.active{background:var(--wine);color:#fff}
.chart-box{position:relative;flex-grow:1;min-height:0;}
.chart-box canvas{display:block;width:100%;height:100%}
.side{display:flex;flex-direction:column;gap:10px}
.card.mini{min-height:auto;padding:12px 10px;}
.card.mini h4{font-size:12px;}
.card.mini .val{font-size:18px;font-weight:500;margin-top:0px}
.card.mini .sub{font-size:11px}
.subgrid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
.subgrid .card{min-height:280px}
.center-badge{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:#fff;border:1px solid var(--line);border-radius:999px;padding:4px 10px;font-weight:800;cursor:pointer}

/* ABA DIAGNÓSTICO ESTILOS */
.diag-kpi-selector { display: flex; align-items: center; gap: 10px; margin-bottom: 12px; background-color: var(--card); border: 1px solid var(--line); padding: 8px 12px; border-radius: 12px; width: fit-content; }
.diag-kpi-selector label { font-size: 14px; color: var(--muted); font-weight: 600; }
.custom-select { border: none; background-color: transparent; font-size: 14px; font-weight: 800; color: var(--wine); cursor: pointer; -webkit-appearance: none; -moz-appearance: none; appearance: none; padding-right: 15px; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%237b1e3a' stroke-linecap='round' stroke-linejoin='round' stroke-width='2.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 0px center; background-size: 1.25em; }
.custom-select:focus { outline: none; }

.diag-layout { display: grid; grid-template-columns: 1.5fr 1fr; gap: 12px; }
.diag-layout .graficos-full-width { grid-column: 1 / -1; }

.diag-card2{background:var(--card);border:1px solid var(--line);border-radius:12px;padding:12px 14px;display:flex;flex-direction:column}

.diag-card2.hero { 
    padding: 20px;
} 
.hero-layout { 
    display: flex; 
    align-items: center; 
    gap: 24px; 
    flex-wrap: wrap; 
    margin-bottom: 16px;
}
.hero-main-kpi { 
    flex-shrink: 0; 
    flex-basis: 320px;
    flex-grow: 1;
}
.hero-main-value { 
    display: flex; 
    align-items: center;
    gap: 16px;
    margin-bottom: 2px; 
}
.hero-value-number { font-size: 30px; font-weight: 700; letter-spacing: -1px; color: var(--ink); }
.hero-main-value .delta { font-size: 13px; padding: 3px 9px; margin-left: 0; }
.hero-sub-value { font-size: 12px; color: var(--muted); }

.hero-units-kpis { 
    display: flex; 
    flex-direction: row;
    gap: 24px; 
    flex-basis: 400px;
    flex-grow: 2;
    padding-left: 24px;
    border-left: 1px dashed var(--line);
}
.unit-kpi-card { 
    flex: 1; 
}
.unit-kpi-title { 
    font-size: 10px; 
    font-weight: 700; 
    color: var(--muted); 
    margin-bottom: 4px; 
    text-transform: uppercase;
    letter-spacing: 0.5px;
}
.unit-kpi-main-value { display: flex; align-items: center; gap: 12px; }
.unit-kpi-value { font-size: 22px; font-weight: 700; color: var(--ink); letter-spacing: -0.5px;}
.unit-kpi-main-value .delta { margin-left: 0; }
.unit-kpi-sub { font-size: 11px; color: var(--muted); margin-top: 2px; }

.hero-context { font-size: 12px; color: var(--ink); background-color: #f8fafc; border: 1px solid var(--line); padding: 8px 10px; border-radius: 8px; width:100%; }

.ins-list{margin:0;padding:0;display:flex;flex-direction:column;gap:8px}
.ins-card{border:1px solid var(--line);border-radius:10px;padding:8px 10px;display:grid;grid-template-columns:auto 1fr;gap:8px;align-items:start;background:#f8fafc}
.ins-card.up{background:#f2f8f6}
.ins-card.down{background:#fcf7f9}
.ins-card .dot{width:10px;height:10px;border-radius:50%;margin-top:4px;background:#94a3b8}
.ins-card.up .dot{background:var(--ok)}
.ins-card.down .dot{background:var(--wine)}
.ins-title{font-weight:800}
.ins-sub{color:#334155;font-size:11px}
.ins-action{font-size:11px;color:#334155;margin-top:2px}
.ins-action strong{color:#111827}
.chart{flex:1;border:1px dashed #d8dbe2;border-radius:10px;display:flex;align-items:center;justify-content:center}
.chart .sk{width:100%;height:100%}
.diag-card2.tall{min-height:340px}

/* ===== ESTILOS PARA PROJEÇÕES (v3) ===== */
.proj-layout-stack { display: flex; flex-direction: column; gap: 16px; padding-top: 12px; flex-grow: 1; justify-content: center; }
.proj-kpi-main { text-align: center; }
.proj-label { font-size: 12px; color: var(--muted); margin-bottom: 2px; font-weight: 600; text-transform: uppercase; }
.proj-value-line { display: flex; justify-content: center; align-items: baseline; gap: 8px; }
.proj-value { font-size: 28px; font-weight: 700; color: var(--ink); letter-spacing: -0.5px; }
.proj-sub-value { font-size: 12px; color: var(--muted); }
.proj-divider { border: 0; height: 1px; background-color: var(--line); margin: 4px 0; }
.proj-units-kpis { display: flex; gap: 16px; justify-content: space-around; }
.proj-units-kpis .unit-kpi-card { text-align: center; }
.proj-units-kpis .unit-kpi-value { font-size: 18px; }
.proj-units-kpis .proj-value-line .delta { font-size: 10px; margin-left: 2px; }
/* ========================================= */

.graficos-grid { display: grid; grid-template-columns: 1.5fr 1fr 1fr; gap: 12px; flex-grow: 1; }

@media (max-width:1200px){
  .panel{grid-template-columns:1fr}
  .diag-layout{grid-template-columns:1fr}
}
@media (max-width: 960px) {
  .hero-layout { flex-direction: column; align-items: stretch; gap: 16px; }
  .hero-units-kpis { border-left: none; padding-left: 0; }
}
@media (max-width: 768px) {
  .kpis, .subgrid { grid-template-columns: 1fr; }
  .upload-bar { flex-wrap: wrap; justify-content: flex-end; gap: 8px;}
  .top { flex-direction: column; align-items: flex-start; }
  .proj-units-kpis { flex-direction: column; align-items: stretch; gap: 12px; }
  .graficos-grid { grid-template-columns: 1fr; }
}

/* RODAPÉ E FILTROS */
.fx-filters-bar{
  position:sticky; bottom:0; z-index:30;
  background:#fff; border-top:1px solid var(--line);
  padding:4px 8px; height:56px; display:flex; align-items:center; gap:8px;
}
.fx-fb-left{display:flex; align-items:center; gap:8px; min-width:0; flex:1}
.fx-fb-title{font-weight:800;color:#334155;white-space:nowrap;font-size:11px}
.fx-chips{display:flex; gap:6px; overflow:auto; scrollbar-width:none}
.fx-chips::-webkit-scrollbar{display:none}
.fx-chip{
  flex:0 0 auto; padding:4px 8px; border:1px solid #e7d5da; border-radius:999px;
  background:#fff; color:var(--wine); font-weight:700; cursor:pointer; font-size:10px
}
.fx-chip.fx-active{background:var(--wine); color:#fff; border-color:var(--wine)}
.fx-fb-right{display:flex; align-items:center; gap:6px}
.fx-iconbtn{display:inline-flex; align-items:center; justify-content:center; width:30px; height:30px; border:1px solid var(--line); border-radius:8px; background:#fff; cursor:pointer}
.fx-cta{padding:6px 10px; border:1px solid var(--wine); background:var(--wine); color:#fff; border-radius:8px; font-weight:800; cursor:pointer; font-size:11px}
.fx-mutedbtn{padding:6px 10px; border:1px solid var(--line); background:#fff; color:#334155; border-radius:8px; font-weight:700; cursor:pointer; font-size:11px}

/* DROP-UP */
.fx-dropup{
  position:fixed; left:8px; right:8px; bottom:60px; z-index:40;
  background:#fff; border:1px solid var(--line); border-radius:12px;
  box-shadow:0 16px 40px rgba(0,0,0,.08);
  padding:0; display:none;
}
.fx-dropup.fx-show{display:block; animation:fx-pop .15s ease-out}
@keyframes fx-pop{from{transform:translateY(8px);opacity:0}to{transform:translateY(0);opacity:1}}
.fx-du-head{position:sticky; top:0; background:#fff; border-bottom:1px solid var(--line); padding:8px 10px; display:flex; align-items:center; justify-content:space-between; border-top-left-radius:12px; border-top-right-radius:12px}
.fx-du-title{font-weight:900; color:#334155; font-size:12px}
.fx-du-actions{display:flex; gap:6px}
.fx-du-body{padding:10px 10px; display:flex; flex-direction:column; gap:10px; max-height:calc(100vh - 200px); overflow:auto}
.fx-du-sec{display:flex; flex-direction:column; gap:8px}
.fx-du-sec + .fx-du-sec{padding-top:8px; border-top:1px dashed var(--line)}
.fx-du-sec h4{margin:0; font-size:11.5px; letter-spacing:.2px; text-transform:uppercase; color:#475569}

.fx-du-grid{
  display:grid; 
  grid-template-columns: repeat(3, 1fr);
  gap:12px 8px; 
}
@media (max-width: 900px) { .fx-du-grid { grid-template-columns: repeat(2, 1fr); } }
@media (max-width: 500px) { .fx-du-grid { grid-template-columns: 1fr; } }

.fx-field{display:flex; flex-direction:column; gap:4px; min-width:0}
.fx-label{font-size:10px; color:#64748b}
.fx-input, .fx-select, .msel .msel-btn {
  height:30px; padding:4px 8px; border:1px solid var(--line); border-radius:8px; background:#fff; font:inherit; width:100%; text-align:left;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.msel { position: relative; }
.msel-panel {
    display: none; position: absolute; top: 100%; left: 0; right: 0; z-index: 50;
    background: #fff; border: 1px solid var(--line); border-radius: 8px;
    box-shadow: 0 10px 24px rgba(0,0,0,.1); max-height: 250px; overflow: auto; padding: 6px;
}
.msel.open .msel-panel { display: block; } 

.fx-period-line{ display:grid; grid-template-columns: 1fr auto 1fr; column-gap: 12px; align-items:end; }
.fx-period-line .fx-quickwrap { grid-column: 1 / -1; margin-top: 8px; }
.fx-input[type="date"]{ width: 100% }
.fx-sep{display:flex; align-items:center; justify-content:center; color:#94a3b8; font-weight:800; padding-bottom: 5px;}
.fx-quickwrap{display:flex; align-items:center; gap:10px; justify-self:start; overflow:visible}
.fx-quick-hint{font-size:10px; color:#94a3b8; white-space:nowrap}
.fx-seg{border-radius:10px; display:inline-flex; border:1px solid var(--line); background:#fff; white-space:nowrap; overflow:hidden}
.fx-seg button{ height:30px; min-width:44px; padding:0 10px; border:0; background:transparent; cursor:pointer; font-weight:800; color:#475569; font-size:10px }
.fx-seg button + button{border-left:1px solid var(--line)}
.fx-seg button.fx-active{background:var(--wine); color:#fff}

@media (max-width:768px){
  .fx-period-line{grid-template-columns: 1fr}
  .fx-sep{display:none}
  .fx-quickwrap{justify-self:start; margin-left:0; margin-top:2px}
}
