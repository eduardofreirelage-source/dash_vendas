<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>DASHBOARD EXECUTIVO — CFO v10.2 (Layout Final)</title>
  <link rel="icon" href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128 128"><rect x="0" y="0" width="128" height="128" rx="24" fill="%232f6ef7"/><text x="64" y="78" text-anchor="middle" font-family="Arial" font-size="56" fill="white">CFO</text></svg>'/>
  
  <link rel="stylesheet" href="Estoque_dash_vendas_styles.css">
</head>
<body>
  <div class="wrap">
    <main class="main main-content">
      <div class="top">
        <div class="brand">
          <div class="tabs" id="tabs">
            <button class="active" data-tab="vendas">Vendas</button>
            <button data-tab="analitico">Analítico</button>
            <button data-tab="diagnostico">Diagnóstico</button>
          </div>
        </div>
        <div class="upload-bar">
          <span id="status" class="muted">—</span><span id="diag" class="diag"></span>
          <div id="uploadInfo" class="upload-info" style="display:none;"></div>
        </div>
      </div>

      <section class="section tab" id="tab-vendas" style="display:block">
        <div class="kpis">
          <div class="kpi active" data-kpi="fat"><h4><span>Faturamento</span><span class="spacer"></span><span id="d_fat" class="delta flat">—</span></h4><div class="val" id="k_fat">—</div><div class="sub">Anterior: <span id="p_fat">—</span></div></div>
          <div class="kpi" data-kpi="ped"><h4><span>Pedidos</span><span class="spacer"></span><span id="d_ped" class="delta flat">—</span></h4><div class="val" id="k_ped">—</div><div class="sub">Anterior: <span id="p_ped">—</span></div></div>
          <div class="kpi" data-kpi="tkt"><h4><span>Ticket Médio</span><span class="spacer"></span><span id="d_tkt" class="delta flat">—</span></h4><div class="val" id="k_tkt">—</div><div class="sub">Anterior: <span id="p_tkt">—</span></div></div>
        </div>
        <div class="panel">
          <div class="card">
            <div class="head">
              <div class="title" id="title_month">Vendas por mês — últimos 12M vs. 12M anteriores</div>
              <div id="segGlobal" class="seg"><button class="seg-btn active" data-mode="total">Total</button><button class="seg-btn" data-mode="media">Média</button></div>
            </div>
            <div class="chart-box"><canvas id="ch_month"></canvas></div>
          </div>
          <div class="side">
            <div class="card mini kpi" data-kpi="fatmed"><h4><span>Faturamento Médio</span><span class="spacer"></span><span id="d_fatmed" class="delta flat">—</span></h4><div class="val" id="k_fatmed">—</div><div class="sub">Anterior: <span id="p_fatmed">—</span></div></div>
            <div class="card mini kpi" data-kpi="des"><h4><span>Incentivos</span><span class="spacer"></span><span id="d_des" class="delta flat">—</span></h4><div class="val" id="k_des">—</div><div class="sub">Anterior: <span id="p_des">—</span></div></div>
            <div class="card mini kpi" data-kpi="desperc"><h4><span>% de Incentivos</span><span class="spacer"></span><span id="d_desperc" class="delta flat">—</span></h4><div class="val" id="k_desperc">—</div><div class="sub">Anterior: <span id="p_desperc">—</span></div></div>
            <div class="card mini kpi" data-kpi="roi"><h4><span>ROI</span><span class="spacer"></span><span id="d_roi" class="delta flat">—</span></h4><div class="val" id="k_roi">—</div><div class="sub">Anterior: <span id="p_roi">—</span></div></div>
            <div class="card mini kpi" data-kpi="canc_val"><h4><span>Valor Cancelado</span><span class="spacer"></span><span id="d_canc_val" class="delta flat">—</span></h4><div class="val" id="k_canc_val">—</div><div class="sub">Anterior: <span id="p_canc_val">—</span></div></div>
          </div>
        </div>
      </section>

      <section class="section tab" id="tab-analitico" style="display:none">
        <div class="kpis">
            <div class="kpi" data-kpi="fre"><h4><span>Frete Total</span><span class="spacer"></span><span id="d_fre" class="delta flat">—</span></h4><div class="val" id="k_fre">—</div><div class="sub">Anterior: <span id="p_fre">—</span></div></div>
            <div class="kpi" data-kpi="fremed"><h4><span>Frete Médio</span><span class="spacer"></span><span id="d_fremed" class="delta flat">—</span></h4><div class="val" id="k_fremed">—</div><div class="sub">Anterior: <span id="p_fremed">—</span></div></div>
            <div class="kpi" data-kpi="canc_ped"><h4><span>Pedidos Cancelados</span><span class="spacer"></span><span id="d_canc_ped" class="delta flat">—</span></h4><div class="val" id="k_canc_ped">—</div><div class="sub">Part.: <span id="k_canc_part">—</span> (Ant.: <span id="p_canc_part">—</span>)</div></div>
            <div class="kpi" style="opacity:.25;pointer-events:none"><h4>Slot livre</h4><div class="val">—</div><div class="sub">Expansão futura</div></div>
        </div>
        <div class="subgrid">
          <div class="card"><div class="head"><div class="title" id="title_top6">Participação por loja — Top 6</div></div><div class="chart-box"><canvas id="ch_top6"></canvas><button id="top6Center" class="center-badge">Total: R$ 0,00</button></div></div>
          <div class="card"><div class="head"><div class="title" id="title_dow">Vendas por dia da semana</div></div><div class="chart-box"><canvas id="ch_dow"></canvas></div></div>
          <div class="card"><div class="head"><div class="title" id="title_hour">Vendas por hora</div></div><div class="chart-box"><canvas id="ch_hour"></canvas></div></div>
          <div class="card"><div class="head"><div class="title" id="title_turno">Vendas por turno</div></div><div class="chart-box"><canvas id="ch_turno"></canvas></div></div>
        </div>
      </section>

      <section class="section tab" id="tab-diagnostico" style="display:none">
        <div class="diag-kpi-selector">
          <label for="kpi-select">Analisando:</label>
          <select id="kpi-select" class="custom-select">
            <option value="fat">Faturamento</option><option value="ped">Pedidos</option><option value="tkt">Ticket Médio</option><option value="des">Incentivos</option><option value="fatmed">Faturamento Médio</option><option value="roi">ROI</option><option value="desperc">% Incentivos</option><option value="canc_val">Valor Cancelado</option><option value="fre">Frete Total</option><option value="fremed">Frete Médio</option><option value="canc_ped">Pedidos Cancelados</option>
          </select>
        </div>
        <div class="diag-layout">
          <div class="diag-card2 hero" style="grid-column: 1 / -1;"><div class="hero-main-value"><span class="hero-value-number">—</span><span class="delta flat" style="font-size: 16px; padding: 4px 10px;">—</span></div><div class="hero-sub-value">Período anterior: —</div><div class="hero-context"><strong>Destaques:</strong> Lojas Savassi e Estoril • <strong>Horário:</strong> 11–14h • <strong>Canal:</strong> Delivery Próprio</div></div>
          <div class="diag-card2 tall"><div class="head"><div class="title">Insights (IA)</div></div><div class="ins-list"><div class="ins-card up"><div class="dot"></div><div><div class="ins-title">Aceleração nas últimas 4 semanas</div><div class="ins-sub">Drivers: pedidos (+8,4%), ticket (+4,0%).</div><div class="ins-action">Ação: reforçar <strong>combos almoço</strong> e replicar vitrine das Top 3.</div></div></div><div class="ins-card down"><div class="dot"></div><div><div class="ins-title">Subsídio acima do ideal no iFood (11–14h)</div><div class="ins-sub">Regra linear reduz margem sem ganho de volume.</div><div class="ins-action">Ação: migrar para <strong>tiers 60/90/120</strong> e condicionar a SLA &lt; 35min.</div></div></div><div class="ins-card up"><div class="dot"></div><div><div class="ins-title">Elasticidade positiva no almoço</div><div class="ins-sub">Mix de combos +2,1pp e preço +R$ 1,12.</div><div class="ins-action">Ação: bundle com sobremesa aos sábados.</div></div></div></div></div>
          <div class="diag-card2"><div class="head"><div class="title">Projeções</div><div class="seg"><button class="active">30D</button><button>60D</button></div></div><div class="proj-content"><div class="proj-chart-area"><div class="chart" style="height:150px" aria-label="gráfico de projeção"><svg class="sk" viewBox="0 0 600 150" preserveAspectRatio="none"><rect x="0" y="140" width="600" height="1" fill="#e5e7eb"/><path d="M10 120 L70 108 L130 96 L190 88 L250 82 L310 74 L370 66 L430 60 L490 54 L550 48" stroke="var(--wine)" stroke-width="3" fill="none"/></svg></div></div><div class="proj-kpis-area"><div class="proj-kpi-main"><div class="proj-label">Receita Projetada</div><div class="proj-value">R$ 1,36M</div></div><div class="proj-kpi-sub"><div class="sub-kpi"><div class="proj-label">Pedidos</div><div class="proj-value-small">34.900</div></div><div class="sub-kpi"><div class="proj-label">Ticket Médio</div><div class="proj-value-small">R$ 39,00</div></div></div></div></div><div style="font-size:11px; color:var(--muted); margin-top:auto; padding-top: 10px;">Obs.: projeção base, sem sazonalidade.</div></div>
          <div class="diag-card2 graficos-full-width"><div class="head"><div class="title">Análise Gráfica Detalhada</div><div class="seg"><button class="active">12M</button><button>6M</button><button>30D</button></div></div><div class="graficos-grid"><div class="chart" aria-label="preview de gráfico"><svg class="sk" viewBox="0 0 600 180" preserveAspectRatio="none"><rect x="0" y="160" width="600" height="1" fill="#e5e7eb"/><rect x="40" y="100" width="24" height="60" fill="var(--wine)"/><rect x="80" y="120" width="24" height="40" fill="var(--wine)"/><rect x="120" y="90" width="24" height="70" fill="var(--wine)"/><rect x="160" y="130" width="24" height="30" fill="var(--wine)"/><rect x="200" y="80" width="24" height="80" fill="var(--wine)"/><path d="M40 140 L80 132 L120 122 L160 136 L200 118 L240 120" stroke="#94a3b8" stroke-width="3" stroke-dasharray="6 6" fill="none"/></svg></div><div class="chart" aria-label="mini gráfico"><svg class="sk" viewBox="0 0 280 90"><rect x="0" y="80" width="280" height="1" fill="#e5e7eb"/><path d="M10 70 L70 50 L140 60 L210 30 L270 36" stroke="var(--wine)" stroke-width="3" fill="none"/></svg></div><div class="chart" aria-label="mini gráfico"><svg class="sk" viewBox="0 0 280 90"><rect x="0" y="80" width="280" height="1" fill="#e5e7eb"/><path d="M10 36 L70 32 L140 28 L210 24 L270 22" stroke="#94a3b8" stroke-width="3" stroke-dasharray="6 6" fill="none"/></svg></div></div></div>
        </div>
      </section>
    </main>
  </div>
  
  <footer class="fx-filters-bar" aria-label="Barra de filtros">
    <div class="fx-fb-left"><div class="fx-fb-title">Filtros:</div><div class="fx-chips" id="fxQuickChips"><button class="fx-chip" data-win="today">Hoje</button><button class="fx-chip" data-win="yesterday">Ontem</button><button class="fx-chip" data-win="lastMonth">Último mês</button><button class="fx-chip" data-win="lastYear">Último ano</button></div></div>
    <div class="fx-fb-right"><button class="fx-iconbtn" id="fxBtnMore" title="Mais filtros" aria-haspopup="dialog" aria-expanded="false"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M4 6h9M4 12h16M4 18h9" stroke="#334155" stroke-width="2" stroke-linecap="round"/><circle cx="16" cy="6" r="2" stroke="#334155" stroke-width="2" fill="none"/><circle cx="9" cy="18" r="2" stroke="#334155" stroke-width="2" fill="none"/><circle cx="12" cy="12" r="2" stroke="#334155" stroke-width="2" fill="none"/></svg></button><button id="btnUpload" class="fx-mutedbtn">IMPORTAR</button><button class="fx-mutedbtn" id="fxBtnReset">Limpar</button></div>
  </footer>
  <input id="fileExcel" type="file" accept=".xlsx,.xls,.csv" style="display:none">

  <div class="fx-dropup" id="fxDropup" role="dialog" aria-modal="true" aria-labelledby="fxDuTitle">
    <div class="fx-du-head"><div class="fx-du-title" id="fxDuTitle">Mais filtros</div><div class="fx-du-actions"><button class="fx-mutedbtn" id="fxDuClose">Fechar</button></div></div>
    <div class="fx-du-body">
      <section class="fx-du-sec" aria-labelledby="fxSecPeriodo"><h4 id="fxSecPeriodo">Período</h4><div class="fx-period-line"><div class="fx-field"><label class="fx-label">Data inicial</label><input type="date" id="fxDuStart" class="fx-input"></div><div class="fx-sep">até</div><div class="fx-field"><label class="fx-label">Data final</label><input type="date" id="fxDuEnd" class="fx-input"></div><div class="fx-quickwrap"><span class="fx-quick-hint">Rápido</span><div class="fx-seg" id="fxDuQuickDays"><button data-win="7">7</button><button data-win="15">15</button><button data-win="30" class="fx-active">30</button><button data-win="60">60</button><button data-win="90">90</button><button data-win="120">120</button></div></div></div></section>
      <section class="fx-du-sec" aria-labelledby="fxSecAnaliticos"><h4 id="fxSecAnaliticos">Analíticos</h4><div class="fx-du-grid"><div class="fx-field"><label class="fx-label">Unidade</label><div id="fxUnit" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Loja</label><div id="fxStore" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Turno</label><div id="fxShift" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Canal</label><div id="fxChannel" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Forma de Pagamento</label><div id="fxPay" class="msel"><button class="msel-btn"></button><div class="msel-panel"></div></div></div><div class="fx-field"><label class="fx-label">Cancelado</label><select id="fxCanceled" class="fx-select"><option value="nao" selected>Não</option><option value="sim">Sim</option><option value="ambos">Ambos</option></select></div></div></section>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js" crossorigin="anonymous"></script>
  
  <script src="Estoque_dash_vendas_app.js"></script>
</body>
</html>
